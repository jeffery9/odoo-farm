<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_product_certificate_document">
        <t t-call="web.external_layout">
            <t t-set="doc" t-value="doc.with_context(lang=doc.lang)"/>
            <div class="page">
                <div class="text-center">
                    <h2>Commitment Certificate for Edible Agri-products</h2>
                    <h3>Certificate of Compliance for Edible Agricultural Products</h3>
                    <img t-att-src="'/report/barcode/?barcode_type=QR&amp;value=%s&amp;width=180&amp;height=180' % doc.certificate_qr_code" style="width:40mm;height:40mm; margin: 10px 0;"/>
                </div>

                <div class="row mt32 mb32">
                    <div class="col-6">
                        <strong>Cert. No.:</strong> <span t-field="doc.certificate_no"/>
                    </div>
                    <div class="col-6">
                        <strong>Lot No.:</strong> <span t-field="doc.lot_id.name"/>
                    </div>
                </div>

                <table class="table table-sm table-bordered">
                    <tr>
                        <td><strong>Producer:</strong></td>
                        <td><span t-field="doc.producer_name"/></td>
                    </tr>
                    <tr>
                        <td><strong>Product Name:</strong></td>
                        <td><span t-field="doc.product_id.name"/></td>
                    </tr>
                    <tr>
                        <td><strong>Production Date:</strong></td>
                        <td><span t-field="doc.production_date" t-options='{"widget": "date"}'/></td>
                    </tr>
                    <tr>
                        <td><strong>Origin:</strong></td>
                        <td><span t-field="doc.origin_location_id.name"/></td>
                    </tr>
                    <tr>
                        <td><strong>Test Results:</strong></td>
                        <td>
                            <t t-if="doc.quality_check_ids">
                                <t t-foreach="doc.quality_check_ids" t-as="qc">
                                    <p><span t-field="qc.point_id.name"/>: <span t-field="qc.quality_state"/></p>
                                </t-foreach>
                            </t>
                            <t t-else="">
                                <p>未进行第三方检测，仅为生产者承诺 / No third-party testing, producer's commitment only.</p>
                            </t>
                        </td>
                    </tr>
                </table>

                <div class="mt-4">
                    <strong>Commitment Statement:</strong>
                    <div t-field="doc.commitment_statement" class="mt-2"/>
                </div>

                <div class="text-right mt-5">
                    <strong>Issue Date:</strong> <span t-esc="datetime.now().strftime('%Y-%m-%d')"/>
                </div>
            </div>
        </t>
    </template>
</odoo>
